(this["webpackJsonpconcrete-crack-detector-app"]=this["webpackJsonpconcrete-crack-detector-app"]||[]).push([[0],{330:function(e,t,n){},340:function(e,t){},341:function(e,t){},349:function(e,t){},352:function(e,t){},353:function(e,t){},356:function(e,t,n){"use strict";n.r(t);var i=n(35),r=n(16),a=n(62),s=n.n(a),o=(n(330),n(64)),c=n(378),l=n(380),d=n(388),u=n(381),h=Object(c.a)((function(e){return{titleText:{margin:"0.2em auto 0.2em 0",fontSize:"1.25rem",fontWeight:300},toolbar:{paddingLeft:32,paddingRight:32,minHeight:56,display:"flex",alignItems:"center"}}}));function p(){var e=h();return Object(i.jsx)(l.a,{children:Object(i.jsxs)("div",{className:e.toolbar,children:[Object(i.jsx)("p",{className:e.titleText,children:"CONCRETE CRACK DETECTOR"}),Object(i.jsx)("a",{href:"https://github.com/tulio-vieira/",style:{textDecoration:"none",color:"inherit",lineHeight:0},children:Object(i.jsx)(u.a,{edge:"end",color:"inherit",children:Object(i.jsx)(d.a,{})})})]})})}var m=n(4),g=n.n(m),b=n(12),j=n(223),f=n(5),x=n(10),v=n(14),O=n(15);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var k=r.createElement("path",{d:"m432 0h-352c-44.113281 0-80 35.886719-80 80v280c0 44.113281 35.886719 80 80 80h273c11.046875 0 20-8.953125 20-20s-8.953125-20-20-20h-73.664062l-45.984376-59.65625 145.722657-185.347656 98.097656 108.421875c5.546875 6.136719 14.300781 8.21875 22.019531 5.246093 7.714844-2.976562 12.808594-10.394531 12.808594-18.664062v-170c0-44.113281-35.886719-80-80-80zm40 198.085938-79.167969-87.503907c-3.953125-4.371093-9.640625-6.785156-15.523437-6.570312-5.886719.207031-11.386719 2.996093-15.03125 7.628906l-154.117188 196.023437-52.320312-67.875c-3.785156-4.910156-9.636719-7.789062-15.839844-7.789062-.003906 0-.007812 0-.011719 0-6.203125.003906-12.058593 2.886719-15.839843 7.804688l-44.015626 57.21875c-6.734374 8.757812-5.097656 21.3125 3.65625 28.046874 8.757813 6.738282 21.3125 5.097657 28.050782-3.65625l28.175781-36.632812 88.816406 115.21875h-148.832031c-22.054688 0-40-17.945312-40-40v-280c0-22.054688 17.945312-40 40-40h352c22.054688 0 40 17.945312 40 40zm0 0"}),C=r.createElement("path",{d:"m140 72c-33.085938 0-60 26.914062-60 60s26.914062 60 60 60 60-26.914062 60-60-26.914062-60-60-60zm0 80c-11.027344 0-20-8.972656-20-20s8.972656-20 20-20 20 8.972656 20 20-8.972656 20-20 20zm0 0"}),S=r.createElement("path",{d:"m468.476562 302.941406c-.058593-.058594-.117187-.121094-.175781-.179687-9.453125-9.519531-22.027343-14.761719-35.410156-14.761719-13.34375 0-25.882813 5.210938-35.324219 14.675781l-38.613281 38.085938c-7.863281 7.753906-7.949219 20.417969-.191406 28.28125 7.753906 7.863281 20.417969 7.953125 28.28125.195312l25.847656-25.492187v112.253906c0 11.046875 8.953125 20 20 20s20-8.953125 20-20v-111.644531l24.738281 25.554687c3.921875 4.054688 9.144532 6.089844 14.371094 6.089844 5.011719 0 10.027344-1.871094 13.910156-5.628906 7.9375-7.683594 8.140625-20.34375.457032-28.28125zm0 0"});function z(e,t){var n=e.title,i=e.titleId,a=y(e,["title","titleId"]);return r.createElement("svg",w({height:"512pt",viewBox:"0 -18 512 512",width:"512pt",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},a),n?r.createElement("title",{id:i},n):null,k,C,S)}var R=r.forwardRef(z),I=(n.p,n(385)),T=n(47),N=n(292),M=n.n(N),B=Object(c.a)((function(e){return{sliderContainer:{textAlign:"center","& p":{margin:"0 0.5em"}},disabled:{textAlign:"center","& p":{margin:"0 0.5em",color:"#707070"}},wrapper:{display:"flex",alignItems:"center",marginBottom:8},slider:{maxWidth:300,appearance:"none",height:15,borderRadius:5,background:"#d3d3d3",outline:"none",opacity:.7,transition:"opacity .2s","&::-webkit-slider-thumb":{appearance:"none",width:25,height:25,borderRadius:"50%",background:e.palette.primary.main,cursor:"pointer"},"&:disabled&::-webkit-slider-thumb":{background:"grey",cursor:"not-allowed"}}}}));function W(e){var t=e.disabled,n=e.value,r=e.min,a=e.max,s=e.onChange,o=B();return Object(i.jsxs)("div",{className:t?o.disabled:o.sliderContainer,children:[Object(i.jsxs)("div",{className:o.wrapper,children:[Object(i.jsx)("p",{children:r}),Object(i.jsx)("input",{className:o.slider,type:"range",disabled:t,value:n,min:r,max:a,onChange:s}),Object(i.jsx)("p",{children:a})]}),Object(i.jsxs)("p",{children:["Window size: ",n,"px"]})]})}var D=n(387),E=n(382),P=n(383);function A(e){var t=e.errorMessage,n=e.errorConfirmed;return Object(i.jsx)(D.a,{open:null!==t,onClose:n,children:Object(i.jsx)(E.a,{children:Object(i.jsx)(P.a,{children:t})})})}var H=n(358),L=227,U=1e3,q=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(f.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).drawBoundaries=function(){var t=e.props,n=t.numCols,i=t.numRows,r=t.predictions,a=e.canvas.getContext("2d");e.canvas.width=U,e.canvas.height=e.props.imgObj.height*U/e.props.imgObj.width,a.clearRect(0,0,e.canvas.width,e.canvas.height);var s=e.canvas.width/(n+1),o=e.canvas.height/(i+1),c=2*s,l=2*o;a.fillStyle="#a90000";for(var d=0;d<i;d++)for(var u=0;u<n;u++){r[d*n+u]&&a.fillRect(s*u,o*d,c,l)}},e}return Object(x.a)(n,[{key:"componentDidMount",value:function(){this.drawBoundaries()}},{key:"componentDidUpdate",value:function(e){this.props.predictions&&this.props.predictions!==e.predictions&&this.drawBoundaries()}},{key:"render",value:function(){var e=this;return Object(i.jsx)("canvas",{className:this.props.classes.canvas,ref:function(t){return e.canvas=t}})}}]),n}(r.Component),J=Object(H.a)((function(){return{canvas:{width:"100%",position:"absolute",zIndex:5,top:0,left:0,filter:"opacity(50%)"}}}))(q),F=n(384),K=n(360),V=Object(c.a)((function(e){return{progressDisplay:{zIndex:8,background:"rgba(0, 0, 0, 0.5)",padding:16,borderRadius:"50%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","& span":{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}}));function _(e){var t=e.progress,n=V();return Object(i.jsxs)("div",{className:n.progressDisplay,children:[Object(i.jsx)(F.a,{variant:"indeterminate",color:"primary"}),Object(i.jsxs)(K.a,{variant:"caption",component:"span",color:"inherit",children:[t,"%"]})]})}var G=n(105),Q=G.f("/concrete-crack-detector-app/tfjs_model/model.json").catch((function(e){console.log(e)})),X=function e(t,n,i,r){var a=this;Object(f.a)(this,e),this.getPredictions=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q;case 2:if(a.model=e.sent,a.model){e.next=5;break}throw new Error("Connection failed");case 5:return e.next=7,new Promise((function(e,t){return a.predictBatch(0,e,t)}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),this.predictBatch=function(){var e=Object(b.a)(g.a.mark((function e(t,n,i){var r,s,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t+84>a.boxes.length?a.boxes.length:t+84,G.c().startScope(),s=G.e.cropAndResize(a.imgTensor,a.boxes.slice(t,r),a.boxIndices.slice(t,r),[L,L]),o=a.model.predict(s),e.next=7,o.data();case 7:o=e.sent.filter((function(e,t){return t%2})).map((function(e){return Math.round(e)})),a.predictions=a.predictions.concat(Array.from(o)),G.c().endScope(),a.setProgress(Math.floor(100*r/a.boxes.length)),r===a.boxes.length?n(a.predictions):setTimeout(a.predictBatch.bind(a,r,n,i),0),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),i(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n,i){return e.apply(this,arguments)}}(),this.getBoxes=function(){for(var e=[],t=[],n=0;n<a.numRows;n++)for(var i=0;i<a.numCols;i++)e.push([n/(a.numRows+1),i/(a.numCols+1),(n+2)/(a.numRows+1),(i+2)/(a.numCols+1)]),t.push((n*a.numRows+i)/(a.numRows*a.numCols));a.boxes=e,a.boxIndices=t},this.imgTensor=G.a.fromPixels(t),this.imgTensor=G.b(this.imgTensor,G.g(255)),this.imgTensor=G.d(this.imgTensor,0),this.numRows=n,this.numCols=i,this.setProgress=r,this.getBoxes(),this.predictions=[]},Y=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(f.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,errorMessage:null,windowSize:null,minWindowSize:null,maxWindowSize:L,predictions:null,imgObj:null,sliderTouched:!0,numRows:0,numCols:0,progress:0},e.fileSelectedHandler=function(t){try{var n=t.target.files[0].name.split(".");if(n=n[n.length-1].toLowerCase(),!["png","jpeg","jpg"].includes(n))return e.setState({errorMessage:"Invalid File type"});var i=new Image;i.src=URL.createObjectURL(t.target.files[0]),i.onload=function(){var t=e.verifyImageDimensions(i.width,i.height);t&&e.setState(Object(j.a)(Object(j.a)({},t),{},{imgObj:i,predictions:null,sliderTouched:!0}))}}catch(r){console.log(r)}},e.makeRequest=Object(b.a)(g.a.mark((function t(){var n,i,r,a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.imgObj){t.next=2;break}return t.abrupt("return");case 2:return n=Math.floor(2*e.state.imgObj.height/e.state.windowSize-1),i=Math.floor(2*e.state.imgObj.width/e.state.windowSize-1),e.setState({loading:!0,numRows:n,numCols:i}),t.prev=5,r=new X(e.state.imgObj,n,i,(function(t){return e.setState({progress:t})})),t.next=9,r.getPredictions();case 9:a=t.sent,e.setState({loading:!1,predictions:a,sliderTouched:!1,progress:0}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),e.setState({loading:!1,errorMessage:t.t0.message||"Something went wrong...",sliderTouched:!1,progress:0});case 16:case"end":return t.stop()}}),t,null,[[5,13]])}))),e.verifyImageDimensions=function(t,n){var i=Math.pow(n*n+7598*n*t+t*t,.5),r=Math.ceil((i-n-t)/1899);r<10&&(r=10);var a=L;return(e.state.maxWindowSize>t||e.state.maxWindowSize>n)&&(a=t<n?t:n),r>a||t<10||n<10?(e.setState({errorMessage:"Invalid size for image"}),!1):{minWindowSize:r,windowSize:Math.ceil((a+r)/2),maxWindowSize:a}},e}return Object(x.a)(n,[{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state.imgObj?100*this.state.windowSize/this.state.imgObj.width+"%":null;return Object(i.jsxs)("div",{className:t.detector,children:[Object(i.jsx)("h2",{className:t.title,children:"Detect concrete cracks with Convolutional Neural Network Classifier!"}),Object(i.jsx)("input",{style:{display:"none"},type:"file",onChange:this.fileSelectedHandler,ref:function(t){return e.fileInput=t}}),this.state.imgObj?Object(i.jsxs)("div",{className:t.display,children:[Object(i.jsx)("img",{src:this.state.imgObj.src,style:{width:"100%"},alt:""}),this.state.predictions&&Object(i.jsx)(J,{imgObj:this.state.imgObj,numRows:this.state.numRows,numCols:this.state.numCols,predictions:this.state.predictions}),this.state.loading&&Object(i.jsx)(_,{progress:this.state.progress}),n&&!this.state.loading&&this.state.sliderTouched&&Object(i.jsx)("div",{className:t.windowPreview,style:{paddingBottom:100*this.state.imgObj.height/this.state.imgObj.width+"%"},children:Object(i.jsx)("div",{className:t.preview,style:{width:n,paddingBottom:n}})})]}):Object(i.jsx)("div",{className:t.upload,onClick:function(){return e.fileInput.click()},children:Object(i.jsx)(R,{className:t.uploadIcon,width:null,height:null})}),Object(i.jsxs)("div",{className:t.options,children:[this.state.imgObj&&Object(i.jsxs)(I.a,{variant:"outlined",disabled:this.state.loading,onClick:function(){return e.fileInput.click()},children:[Object(i.jsx)(M.a,{}),Object(i.jsx)("span",{style:{marginLeft:"0.5em"},children:"Choose Image"})]}),this.state.imgObj&&Object(i.jsx)(W,{disabled:this.state.loading,value:this.state.windowSize,min:this.state.minWindowSize,max:this.state.maxWindowSize,onChange:function(t){return e.setState({windowSize:t.target.value,sliderTouched:!0})}}),this.state.imgObj&&Object(i.jsx)(I.a,{variant:"contained",color:"secondary",disabled:this.state.loading||!this.state.sliderTouched,onClick:this.makeRequest,children:"Detect"})]}),Object(i.jsx)(A,{errorMessage:this.state.errorMessage,errorConfirmed:function(){return e.setState({errorMessage:null})}})]})}}]),n}(r.Component),Z=Object(T.a)((function(e){return Object(o.a)({detector:{marginTop:24,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},upload:{marginTop:16,backgroundColor:"#adadad",padding:16,borderRadius:16,transition:"background-color 0.1s ease","&:hover":{cursor:"pointer",backgroundColor:"#616161"}},title:{fontWeight:400},uploadIcon:{height:100,verticalAlign:"middle",margin:"0 auto",fill:"#314198"},options:{display:"flex",alignItems:"center",padding:"32px 0",justifyContent:"space-around",alignSelf:"stretch"},display:{width:"100%",maxWidth:1e3,position:"relative",border:"5px solid #404040",borderRadius:3},windowPreview:{position:"absolute",top:0,left:0,zIndex:10,height:0,width:"100%",overflow:"hidden"},preview:{position:"absolute",height:0,top:"50%",left:"50%",transform:"translate(-50%, -50%)",border:"5px solid red",outline:"600px solid rgba(0, 0, 0, 0.5)"}},e.breakpoints.down(450),{options:{flexDirection:"column","& div":{order:-1},"& > *":{margin:"8px 0"}}})}))(Y),$=n(293),ee=n(386),te=n(218),ne=n(219),ie=Object(c.a)((function(e){var t;return{wrapper:(t={margin:"0 20%",paddingTop:60,minHeight:"calc(100vh - 60px - 72.8px)"},Object(o.a)(t,e.breakpoints.down(960),{margin:"0 10%"}),Object(o.a)(t,e.breakpoints.down(600),{margin:"0 5%"}),Object(o.a)(t,e.breakpoints.down(350),{margin:"0 16px"}),t),footer:{width:"100%",textAlign:"center",padding:"8px 0",backgroundColor:"#212121","& p":{fontSize:"0.8em",margin:"0.5em",color:"#cacaca"},"& a":{display:"inline-flex",alignItems:"center",color:"inherit"}}}}));function re(){var e=ie(),t=Object($.a)({palette:{type:"dark",primary:te.a,secondary:ne.a}});return Object(i.jsxs)(ee.a,{theme:t,children:[Object(i.jsx)(p,{}),Object(i.jsx)("main",{className:e.wrapper,children:Object(i.jsx)(Z,{})}),Object(i.jsxs)("footer",{className:e.footer,children:[Object(i.jsx)("p",{children:"Created by: Tulio Vieira"}),Object(i.jsx)("p",{children:Object(i.jsxs)("a",{href:"https://github.com/tulio-vieira/",children:[Object(i.jsx)(d.a,{style:{height:"0.8em"}}),Object(i.jsx)("span",{children:"/tulio-vieira"})]})})]})]})}s.a.render(Object(i.jsx)(re,{}),document.getElementById("root"))}},[[356,1,2]]]);
//# sourceMappingURL=main.56187594.chunk.js.map